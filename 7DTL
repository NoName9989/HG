local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

-- Tạo cửa sổ GUI
local Window = Rayfield:CreateWindow({
    Name = "HG❤Hub",
    LoadingTitle = "[7DTL]Đang tải...",
    LoadingSubtitle = "by HenGi",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "HGhub",
        FileName = "Settings"
    },
    KeySystem = false
})

-- Tabs (đã sửa lại tên và icon hợp lý)
local MainTab = Window:CreateTab("Main", 7539983773)              
local PlayerTab = Window:CreateTab("Player", 130156611516915)              
local ESPTab = Window:CreateTab("ESP", 18155313082)    
local MiscTab = Window:CreateTab("Misc", 133142974652905)
local SettingTab = Window:CreateTab("Setting", 4859271243)        
-- Biến
local Players = game:GetService("Players")
local player = Players.LocalPlayer

-- MainTab

-- PlayerTab

-- ESPTab
-- Chức năng 1
local homeESPPart

ESPTab:CreateToggle({
    Name = "Home ESP",
    CurrentValue = false,
    Callback = function(state)
        if state then
            -- Bật ESP: tạo marker
            if not homeESPPart then
                local position = Vector3.new(53.0, 41.7, 416.8)

                homeESPPart = Instance.new("Part")
                homeESPPart.Name = "HomeESP_Marker"
                homeESPPart.Anchored = true
                homeESPPart.CanCollide = false
                homeESPPart.Size = Vector3.new(1, 1, 1)
                homeESPPart.Position = position
                homeESPPart.Transparency = 1
                homeESPPart.Parent = workspace

                local billboard = Instance.new("BillboardGui")
                billboard.Size = UDim2.new(0, 100, 0, 40)
                billboard.Adornee = homeESPPart
                billboard.AlwaysOnTop = true
                billboard.Parent = homeESPPart

                local label = Instance.new("TextLabel")
                label.Size = UDim2.new(1, 0, 1, 0)
                label.BackgroundTransparency = 1
                label.TextScaled = true
                label.Text = "Home"
                label.TextColor3 = Color3.fromRGB(255, 0, 0)
                label.Font = Enum.Font.GothamBold
                label.Parent = billboard
            end
        else
            -- Tắt ESP: xóa marker
            if homeESPPart then
                homeESPPart:Destroy()
                homeESPPart = nil
            end
        end
    end
})

-- chức năng 2
local scrapESPEnabled = false
local scrapESPThread = nil

local function clearOldESP()
	for _, scrap in pairs(workspace.scraps:GetChildren()) do
		local part = scrap:FindFirstChild("defaultMaterial10")
		if part and part:FindFirstChild("ScrapESP") then
			part.ScrapESP:Destroy()
		end
	end
end

local function createScrapESP()
	for _, scrap in pairs(workspace.scraps:GetChildren()) do
		local part = scrap:FindFirstChild("defaultMaterial10")
		if part and part:IsA("BasePart") and not part:FindFirstChild("ScrapESP") then
			local gui = Instance.new("BillboardGui")
			gui.Name = "ScrapESP"
			gui.Adornee = part
			gui.Size = UDim2.new(0, 100, 0, 40)
			gui.AlwaysOnTop = true
			gui.Parent = part

			local label = Instance.new("TextLabel")
			label.Size = UDim2.new(1, 0, 1, 0)
			label.BackgroundTransparency = 1
			label.Text = "Scrap"
			label.TextColor3 = Color3.fromRGB(255, 255, 0)
			label.TextScaled = true
			label.Font = Enum.Font.GothamBold
			label.Parent = gui
		end
	end
end

-- Nút bật/tắt trong ESP Tab
ESPTab:CreateToggle({
	Name = "Scrap ESP",
	CurrentValue = false,
	Callback = function(state)
		scrapESPEnabled = state

		if state then
			scrapESPThread = task.spawn(function()
				while scrapESPEnabled do
					clearOldESP()
					createScrapESP()
					task.wait(3)
				end
			end)
		else
			clearOldESP()
			if scrapESPThread then
				task.cancel(scrapESPThread)
				scrapESPThread = nil
			end
		end
	end
})

--chức năng 3
-- BIẾN
local animalESPEnabled = false
local animalESPThread = nil

-- HÀM XÓA ESP CŨ
local function clearOldESP()
	for _, animal in pairs(workspace.animals:GetChildren()) do
		local head = animal:FindFirstChild("Head")
		if head and head:FindFirstChild("AnimalESP") then
			head.AnimalESP:Destroy()
		end
	end
end

-- HÀM TẠO ESP
local function createAnimalESP()
	for _, animal in pairs(workspace.animals:GetChildren()) do
		local head = animal:FindFirstChild("Head")
		if head and head:IsA("BasePart") and not head:FindFirstChild("AnimalESP") then
			local gui = Instance.new("BillboardGui")
			gui.Name = "AnimalESP"
			gui.Adornee = head
			gui.Size = UDim2.new(0, 100, 0, 40)
			gui.AlwaysOnTop = true
			gui.Parent = head

			local label = Instance.new("TextLabel")
			label.Size = UDim2.new(1, 0, 1, 0)
			label.BackgroundTransparency = 1
			label.Text = "Animal"
			label.TextColor3 = Color3.fromRGB(0, 255, 0)
			label.TextScaled = true
			label.Font = Enum.Font.GothamBold
			label.Parent = gui
		end
	end
end

-- NÚT BẬT/TẮT TRONG TAB ESP
ESPTab:CreateToggle({
	Name = "Animal ESP",
	CurrentValue = false,
	Callback = function(state)
		animalESPEnabled = state

		if state then
			animalESPThread = task.spawn(function()
				while animalESPEnabled do
					clearOldESP()
					createAnimalESP()
					task.wait(3)
				end
			end)
		else
			clearOldESP()
			if animalESPThread then
				task.cancel(animalESPThread)
				animalESPThread = nil
			end
		end
	end
})

--chức năng 3
-- BIẾN
local animalESPEnabled = false
local animalESPThread = nil

-- XÓA ESP CŨ
local function clearOldESP()
	for _, animal in pairs(workspace.interact:GetChildren()) do
		if animal:IsA("Model") then
			local eyes = animal:FindFirstChild("Eyes")
			if eyes and eyes:FindFirstChild("AnimalDieESP") then
				eyes.AnimalDieESP:Destroy()
			end
		end
	end
end

-- TẠO ESP CHO ĐỘNG VẬT CHẾT (gắn vào Eyes)
local function createAnimalDieESP()
	for _, animal in pairs(workspace.interact:GetChildren()) do
		if animal:IsA("Model") then
			local eyes = animal:FindFirstChild("Eyes")
			local humanoid = animal:FindFirstChildOfClass("Humanoid")
			if eyes and humanoid and humanoid.Health <= 0 and not eyes:FindFirstChild("AnimalDieESP") then
				local gui = Instance.new("BillboardGui")
				gui.Name = "AnimalDieESP"
				gui.Adornee = eyes
				gui.Size = UDim2.new(0, 100, 0, 40)
				gui.AlwaysOnTop = true
				gui.Parent = eyes

				local label = Instance.new("TextLabel")
				label.Size = UDim2.new(1, 0, 1, 0)
				label.BackgroundTransparency = 1
				label.Text = "Dead Animal"
				label.TextColor3 = Color3.fromRGB(255, 0, 0)
				label.TextScaled = true
				label.Font = Enum.Font.GothamBold
				label.Parent = gui
			end
		end
	end
end

-- NÚT BẬT/TẮT TRONG ESP TAB
ESPTab:CreateToggle({
	Name = "Animal Die ESP",
	CurrentValue = false,
	Callback = function(state)
		animalESPEnabled = state

		if state then
			animalESPThread = task.spawn(function()
				while animalESPEnabled do
					clearOldESP()
					createAnimalDieESP()
					task.wait(3)
				end
			end)
		else
			clearOldESP()
			if animalESPThread then
				task.cancel(animalESPThread)
				animalESPThread = nil
			end
		end
	end
})
